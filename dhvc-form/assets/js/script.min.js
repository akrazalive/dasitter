!function($){"use strict";$(document).ready(function(){$("select.dhvc-select-with-placeholder").on("change",function(){""==$(this).val()?$(this).addClass("dhvc-select-not-selected"):$(this).removeClass("dhvc-select-not-selected")}).trigger("change"),$("[data-auto-open].dhvc-form-popup").each(function(){var e,t,a=$(this),r=a.attr("id"),o=a.data("open-delay"),d=a.data("auto-close"),c=a.data("close-delay"),n=a.data("one-time");clearTimeout(void 0),clearTimeout(t),e=setTimeout(function(){clearTimeout(t),n?$.cookie(r)||($(".dhvc-form-pop-overlay").show(),$("body").addClass("dhvc-form-opening"),a.show(),$.cookie(r,1,{expires:3600,path:"/"})):($.cookie(r,0,{expires:-1}),$(".dhvc-form-pop-overlay").show(),a.show())},o),d&&(t=setTimeout(function(){clearTimeout(e),$(".dhvc-form-pop-overlay").hide(),$("body").addClass("dhvc-form-opening"),a.hide()},c))}),$(document).on("click",'[data-toggle="dhvcformpopup"],[rel="dhvcformpopup"],[href^="#dhvcformpopup-"]',function(e){var t;e.stopPropagation(),e.preventDefault();var a=$(this),r=$(a.attr("data-target")||(t=a.attr("href"))&&t.replace(/.*(?=#[^\s]+$)/,""));a.is("a")&&e.preventDefault(),$(".dhvc-form-pop-overlay").show(),$("body").addClass("dhvc-form-opening"),r.show(),r.off("click").on("click",function(e){e.target===e.currentTarget&&($(".dhvc-form-pop-overlay").hide(),$("body").removeClass("dhvc-form-opening"),r.hide())})}),$(document).on("click",".dhvc-form-popup-close",function(e){$(".dhvc-form-pop-overlay").hide(),$("body").removeClass("dhvc-form-opening"),$(this).closest(".dhvc-form-popup").hide()}),$(".dhvc-form-slider-control").each(function(){var a=$(this);a.slider({min:a.data("min"),max:a.data("max"),step:a.data("step"),range:"range"==a.data("type")||"min",slide:function(e,t){"range"==a.data("type")?(a.closest(".dhvc-form-group").find(".dhvc-form-slider-value-from").text(t.values[0]),a.closest(".dhvc-form-group").find(".dhvc-form-slider-value-to").text(t.values[1]),a.closest(".dhvc-form-group").find('input[type="hidden"]').val(t.values[0]+"-"+t.values[1]).trigger("change")):(a.closest(".dhvc-form-group").find(".dhvc-form-slider-value").text(t.value),a.closest(".dhvc-form-group").find('input[type="hidden"]').val(t.value).trigger("change"))}}),"range"==a.data("type")?a.slider("values",[0,a.data("minmax")]):a.slider("value",a.data("value"))});var basename=function(e,t){var a=e,e=a.charAt(a.length-1);return"/"!==e&&"\\"!==e||(a=a.slice(0,-1)),a=a.replace(/^.*[\/\\]/g,""),"string"==typeof t&&a.substr(a.length-t.length)==t&&(a=a.substr(0,a.length-t.length)),a},operators={">":function(e,t){return t<e},"=":function(e,t){return e==t},"<":function(e,t){return e<t}},get_field_val=function(e,t){t=$(t),e=$(e);return e.is(":checkbox")?$.map(t.find("[data-conditional-name="+e.data("conditional-name")+"].dhvc-form-value:checked"),function(e){return $(e).val()}):(e.is(":radio")?t.find("[data-conditional-name="+e.data("conditional-name")+"].dhvc-form-value:checked"):e).val()},conditional_hook=function(e){var t=$(e.currentTarget),r=t.closest("form"),o=dhvcformL10n.container_class,d=t.closest(o),e=t.data("conditional"),a=[],c=null,n=get_field_val(t,r);return(t.is(":checkbox")?!r.find("[data-conditional-name="+t.data("conditional-name")+"].dhvc-form-value:checked").length:t.is(":radio")?!r.find("[data-conditional-name="+t.data("conditional-name")+"].dhvc-form-value:checked").val():!n.length)?($.each(e,function(e,t){t=t.element.split(",");$.each(t,function(e,t){t=r.find(".dhvc-form-control-"+t);t.closest(o).addClass("dhvc-form-hidden"),t.trigger("change")})}),$.each(e,function(e,t){var a=t.element.split(",");"is_empty"==t.type&&("hide"==t.action?$.each(a,function(e,t){t=r.find(".dhvc-form-control-"+t);t.closest(o).addClass("dhvc-form-hidden"),t.trigger("change")}):$.each(a,function(e,t){t=r.find(".dhvc-form-control-"+t);t.closest(o).removeClass("dhvc-form-hidden"),t.trigger("change")}))})):($.isNumeric(n)&&(n=parseInt(n)),$.each(e,function(e,t){t.value==n?c=t:a.push(t)}),null!=c&&(a.push(c),e=a),$.each(e,function(e,t){var a=t.element.split(",");d.hasClass("dhvc-form-hidden")?$.each(a,function(e,t){t=r.find(".dhvc-form-control-"+t);t.closest(o).addClass("dhvc-form-hidden"),t.trigger("change")}):"not_empty"==t.type?"hide"==t.action?$.each(a,function(e,t){t=r.find(".dhvc-form-control-"+t);t.closest(o).addClass("dhvc-form-hidden"),t.trigger("change")}):$.each(a,function(e,t){t=r.find(".dhvc-form-control-"+t);t.closest(o).removeClass("dhvc-form-hidden"),t.trigger("change")}):"is_empty"==t.type?"hide"==t.action?$.each(a,function(e,t){t=r.find(".dhvc-form-control-"+t);t.closest(o).removeClass("dhvc-form-hidden"),t.trigger("change")}):$.each(a,function(e,t){t=r.find(".dhvc-form-control-"+t);t.closest(o).addClass("dhvc-form-hidden"),t.trigger("change")}):$.isArray(n)?-1<$.inArray(t.value,n)?"hide"==t.action?$.each(a,function(e,t){t=r.find(".dhvc-form-control-"+t);t.closest(o).addClass("dhvc-form-hidden"),t.trigger("change")}):$.each(a,function(e,t){t=r.find(".dhvc-form-control-"+t);t.closest(o).removeClass("dhvc-form-hidden"),t.trigger("change")}):"hide"==t.action?$.each(a,function(e,t){t=r.find(".dhvc-form-control-"+t);t.closest(o).removeClass("dhvc-form-hidden"),t.trigger("change")}):$.each(a,function(e,t){t=r.find(".dhvc-form-control-"+t);t.closest(o).addClass("dhvc-form-hidden"),t.trigger("change")}):($.isNumeric(n)&&(n=parseInt(n)),$.isNumeric(t.value)&&"0"!=t.value&&(t.value=parseInt(t.value)),"not_empty"!=t.type&&"is_empty"!=t.type&&operators[t.type](n,t.value)?"hide"==t.action?$.each(a,function(e,t){t=r.find(".dhvc-form-control-"+t);t.closest(o).addClass("dhvc-form-hidden"),t.trigger("change")}):$.each(a,function(e,t){t=r.find(".dhvc-form-control-"+t);t.closest(o).removeClass("dhvc-form-hidden"),t.trigger("change")}):"hide"==t.action?$.each(a,function(e,t){t=r.find(".dhvc-form-control-"+t);t.closest(o).removeClass("dhvc-form-hidden"),t.trigger("change")}):$.each(a,function(e,t){t=r.find(".dhvc-form-control-"+t);t.closest(o).addClass("dhvc-form-hidden"),t.trigger("change")}))})),!0},update_hidden_fields=function(e){var e=$(e),t=[];e.find(".dhvc-form-value,.dhvc-form-recaptcha").filter(function(){var e=$(this).attr("data-name")||this.name;return!(0<=$.inArray(e,t)||$(this).is(":visible"))&&(t.push(e),!0)}),e.find("input[name=_dhvc_form_hidden_fields]").val(JSON.stringify(t))},conditional_form=function(e,t){e=$(e).find(".dhvc-form-conditional"),t=t||!1;$.each(e,function(){var e=$(this).find("[data-conditional].dhvc-form-value");!1===t&&$(e).on("keyup change",function(e){conditional_hook(e)}),$.each(e,function(){var e=$(this);conditional_hook({currentTarget:e})})})},form_price_format=function(e,t){var a=$(e),e=(a.data("currency"),a.data("currency_symbol"));return a.data("price_format").replace("%s",e).replace("%v",t)},form_math=function(form){var $form=$(form),maths=[];$(".dhvc-form-math",$form).each(function(){var match,match_value=0,$this=$(this),pattern=/\[(.*?)\]/g,operators=$this.data("value-math"),match_value_formated;if(!$.isNumeric(operators)){if(""===operators.replace(/[^.*()\-+\/]+/g,""))var $el=$("[data-field-name="+operators+"]",$form),field_value=parseFloat(get_field_val($el,$form)),field_value=isNaN(field_value)?0:field_value,match_value=field_value;else{var fields=operators.split(/[*()\-+\/]/);$.each(fields,function(e,t){var a;""==t.trim()||(a=$("[data-field-name="+t+"]",$form)).length&&(a=parseFloat(get_field_val(a,$form)),a=isNaN(a)?0:a,t=new RegExp(t,"g"),operators=operators.replace(t,a))});try{match_value=parseFloat(eval(operators).toFixed(2))}catch(e){match_value=0}}$this.hasClass("paypal-item-price-value")?(match_value_formated=form_price_format($form,match_value),$this.html(match_value_formated)):$this.html(match_value),$this.data("result-math",match_value),$(document.body).trigger("dhvc_form_math_change",[$form])}})};$(document.body).on("dhvc_form_math_change",function(e,t){var a=0,t=$(t);$(".paypal-item-price-value",t).each(function(){a+=parseFloat($(this).data("result-math"))}),$(".paypal-total-value",t).html(form_price_format(t,a))}),$().xdsoftDatetimepicker&&"function"==typeof $.xdsoftDatetimepicker.setLocale&&$.xdsoftDatetimepicker.setLocale(dhvcformL10n.datetimepicker_lang);var form_submit_loading=function(e,t){t=t||!1;var a=$(e),r=a.find(".dhvc-form-submit"),e=a.find(".dhvc-form-submit-label"),a=a.find(".dhvc-form-submit-spinner");t?(r.removeAttr("disabled"),e.removeClass("dhvc-form-submit-label-hidden"),a.hide()):(r.attr("disabled","disabled"),e.addClass("dhvc-form-submit-label-hidden"),a.show())};$(".dhvc-form-datepicker").length&&$(".dhvc-form-datepicker").each(function(){var e=$(this),t={format:dhvcformL10n.date_format,formatDate:dhvcformL10n.date_format,timepicker:!1,scrollMonth:!1,dayOfWeekStart:parseInt(dhvcformL10n.dayofweekstart),scrollTime:!1,minDate:e.data("min-date"),maxDate:e.data("max-date"),yearStart:e.data("year-start"),yearEnd:e.data("year-end"),scrollInput:!1},a=e.data("disable-weekend");a&&(t.onGenerate="sat"===a?function(){$(this).find(".xdsoft_date.xdsoft_weekend--sat").addClass("xdsoft_disabled")}:"sun"===a?function(){$(this).find(".xdsoft_date.xdsoft_weekend--sun").addClass("xdsoft_disabled")}:function(){$(this).find(".xdsoft_date.xdsoft_weekend").addClass("xdsoft_disabled")}),e.xdsoftDatetimepicker(t)}),$(".dhvc-form-timepicker").length&&$(".dhvc-form-timepicker").each(function(){var e=$(this);e.xdsoftDatetimepicker({format:dhvcformL10n.time_format,formatTime:dhvcformL10n.time_format,datepicker:!1,scrollMonth:!1,scrollTime:!0,scrollInput:!1,dayOfWeekStart:parseInt(dhvcformL10n.dayofweekstart),minTime:e.data("min-time"),maxTime:e.data("max-time"),yearStart:e.data("year-start"),yearEnd:e.data("year-end"),step:parseInt(dhvcformL10n.time_picker_step)})}),$(".dhvc-form-datetimepicker").length&&$(".dhvc-form-datetimepicker").each(function(){var e=$(this),t={format:dhvcformL10n.date_format+" "+dhvcformL10n.time_format,datepicker:!0,scrollMonth:!1,scrollTime:!0,scrollInput:!1,minTime:e.data("min-time"),maxTime:e.data("max-time"),minDate:e.data("min-date"),maxDate:e.data("max-date"),yearStart:e.data("year-start"),yearEnd:e.data("year-end"),step:parseInt(dhvcformL10n.time_picker_step)},a=e.data("disable-weekend");a&&(t.onGenerate="sat"===a?function(){$(this).find(".xdsoft_date.xdsoft_weekend--sat").addClass("xdsoft_disabled")}:"sun"===a?function(){$(this).find(".xdsoft_date.xdsoft_weekend--sun").addClass("xdsoft_disabled")}:function(){$(this).find(".xdsoft_date.xdsoft_weekend").addClass("xdsoft_disabled")}),e.xdsoftDatetimepicker(t)}),$(".dhvc-form-control[data-range_field]").each(function(){var c=$(this),e=c.closest("form"),t=c.data("range_field"),n=$('.dhvc-form-control[data-field-name="'+t+'"]',e);n.xdsoftDatetimepicker("setOptions",{onChangeDateTime:function(e,t,a,r){var o,d;e&&(o=new Date(e.getFullYear(),e.getMonth(),e.getDate()+parseInt(c.data("range_field_start_current")),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()).toString(),"yes"===c.data("range_field_set_value")&&(d=n.data("xdsoft_datetimepicker").getDateHelper(),e=c.hasClass("dhvc-form-datetimepicker")?dhvcformL10n.date_format+" "+dhvcformL10n.time_format:dhvcformL10n.date_format,e=d.formatDate(new Date(o),e),c.val(e).attr("value",e),c.trigger("change")),c.xdsoftDatetimepicker("reset").xdsoftDatetimepicker("setOptions",{minDate:new Date(o)}))}})});var initForm=function(form){var $form=$(form),submiting=!1,submitBtn=$form.find(".dhvc-form-submit");$(".dhvc-form-file",$form).find("input[type=file]").on("change",function(){var e=$(this).val();$(this).closest("label").find(".dhvc-form-control").prop("value",basename(e))}),$(".dhvc-form-file",$form).each(function(){$(this).find('input[type="text"]').css({"padding-right":$(this).find(".dhvc-form-file-button").outerWidth(!0)+"px"}),$(this).find('input[type="text"]').on("click",function(){$(this).closest("label").trigger("click")})}),$().tooltip&&$(".dhvc-form-rate .dhvc-form-rate-star",$form).tooltip({html:!0,container:$("body")});var clearResponse=function(e){e=$(e);e.removeClass("invalid spam sent failed"),$("[aria-invalid]",e).attr("aria-invalid","false"),$(".dhvc-form-error",e).remove(),$(".dhvc-form-control",e).removeClass("dhvc-form-not-valid"),$(".dhvc-form-message",e.parent()).hide().empty().removeAttr("role").removeClass("dhvc-form-validation-errors dhvc-form-spam dhvc-form-errors dhvc-form-success")},refill=function(e,t){var a,r,e=$(e);t.captcha&&(a=e,r=t.captcha,$.each(r,function(e,t){a.find(':input[name="'+e+'"]').val(""),a.find("img.dhvc-form-captcha-img-"+e).attr("src",t);t=/([0-9]+)\.(png|gif|jpeg)$/.exec(t);a.find('input:hidden[name="_dhvc_form_captcha_challenge_'+e+'"]').attr("value",t[1])}))},notValidTip=function(e,t){var a;""!=t&&(a=$(e),$(".dhvc-form-error",a).remove(),(e=$('<span role="alert" class="dhvc-form-error"></span>')).text(t),!a.is(":radio")&&!a.is(":checkbox")&&"recaptcha"==a.attr("data-dhvcform-recaptcha")?e.appendTo(a.closest(".dhvc-form-group")):e.appendTo(a.parent().parent()))},form_step_click_init=function(e){var r=$(e);$(".dhvc-form-step",r).on("click",function(e){var t,a=$(this);e.stopPropagation(),e.preventDefault(),a.hasClass("actived")&&($(".dhvc-form-message.dhvc-form-success",r.parent()).hide().empty().removeAttr("role").removeClass("dhvc-form-validation-errors dhvc-form-spam dhvc-form-errors dhvc-form-success"),t=parseInt($(this).data("step-index")),parseInt($("#_dhvc_form_current_step",r).val()),a.siblings(".dhvc-form-step.active").removeClass("active").addClass("actived"),a.removeClass("actived").addClass("active"),$(".dhvc-form-step-content",r).removeClass("active"),$(".dhvc-form-step-content-"+t,r).addClass("active"),$("#_dhvc_form_current_step",r).val(t),$(".dhvc-form-value",r).on("input.dhvcform change.dhvcform",function(){var e=$(this).closest(".dhvc-form-step-content").data("content_step");r.find("[data-step-index="+e+"]").nextAll().removeClass("active actived"),$("#_dhvc_form_current_step",r).val(t)}))})};form_step_click_init($form);var ajaxSuccess=function(data,status,xhr,$form){var $message=$(".dhvc-form-message",$form.parent()),step_final;switch(data.status){case"validation_failed":var firstInvalidFields=null;$.each(data.invalid_fields,function(e,t){var a=$(t.into,$form);firstInvalidFields=firstInvalidFields||a,notValidTip(a,t.reason),$(".dhvc-form-control",a.closest(".dhvc-form-group")).addClass("dhvc-form-not-valid"),$("[aria-invalid]",a).attr("aria-invalid","true")});try{firstInvalidFields.focus().trigger("focusin")}catch(e){}$message.addClass("dhvc-form-validation-errors"),$form.addClass("invalid"),$(document.body).trigger("dhvc_form_invalid",[$form,data]);break;case"success":if($form.find("#_dhvc_form_steps").length&&(step_final='<div class="dhvc-form-steps-final"></div>',$form.find(".dhvc-form-step-contents").append($(step_final))),data.onOk&&$.each(data.onOk,function(i,n){eval(n)}),$message.addClass("dhvc-form-success"),$(document.body).trigger("dhvc_form_success",[$form,data]),$form.hasClass("dhvcform-action-external-url"))return $form.find("._dhvc_form_ignore_field").each(function(){$(this).remove()}),void $form.submit();break;case"spam":$message.addClass("dhvc-form-spam"),$(document.body).trigger("dhvc_form_spam",[$form,data]);break;case"upload_failed":$message.addClass("dhvc-form-errors"),$(document.body).trigger("dhvc_form_upload_failed",[$form,data]);break;case"form_not_exist":$message.addClass("dhvc-form-errors"),$(document.body).trigger("dhvc_form_not_exist",[$form,data]);break;case"action_failed":$message.addClass("dhvc-form-errors"),$(document.body).trigger("dhvc_form_action_failed",[$form,data]);break;case"call_action_failed":$message.addClass("dhvc-form-errors"),$(document.body).trigger("dhvc_form_call_action_failed",[$form,data]);break;case"next_step":var $current_step_input=$("#_dhvc_form_current_step",$form),$current_step=parseInt($current_step_input.val()),$all_steps=parseInt($("#_dhvc_form_steps",$form).val()),$next_step=$current_step+1;$next_step<=$all_steps&&($(".dhvc-form-steps",$form).find(".active").removeClass("active"),$(".dhvc-form-step-"+$current_step,$form).addClass("actived"),$(".dhvc-form-step-"+$next_step,$form).removeClass("actived").addClass("active"),$(".dhvc-form-step-content",$form).removeClass("active"),$(".dhvc-form-step-content-"+$next_step,$form).addClass("active"),$("#_dhvc_form_current_step",$form).val($next_step))}refill($form,data),$(document.body).trigger("dhvc_form_submit",[$form,data]),"success"===data.status&&($form.each(function(){this.reset()}),conditional_form($form,!0),data.refresh?window.location.reload():data.redirect&&(window.location=data.redirect)),data.redirect||""==data.message||($message.html(data.message),$message.attr("role","alert"),$form.find(".dhvc-form-steps-final").length?($(".dhvc-form-step-content").each(function(){$(this).remove()}),$form.find(".dhvc-form-steps-final").html($message.clone()),$message.remove()):$message.slideDown("fast"))};$form.on("submit",function(e){var t;submiting||"function"!=typeof window.FormData||(submiting=!0,clearResponse($form),update_hidden_fields($form),t=new FormData($form.get(0)),$.ajax({type:"POST",url:dhvcformL10n.ajax_submit_url,data:t,dataType:"json",processData:!1,contentType:!1,beforeSend:function(){$(document.body).trigger("dhvc_form_before_submit",[$form,submitBtn]),form_submit_loading($form,!1)}}).done(function(e,t,a){$(document.body).trigger("dhvc_form_after_submit",[$(form),submitBtn,e]),ajaxSuccess(e,t,a,$form),form_submit_loading($form,!(submiting=!1))}).fail(function(e,t,a){form_submit_loading($form,!(submiting=!1))}),e.preventDefault())})},woocommerce_formart_price=function(e){return"undefined"==typeof dhwc_form_product_price_params?e:accounting.formatMoney(e,{symbol:dhwc_form_product_price_params.currency_format_symbol,decimal:dhwc_form_product_price_params.currency_format_decimal_sep,thousand:dhwc_form_product_price_params.currency_format_thousand_sep,precision:dhwc_form_product_price_params.currency_format_num_decimals,format:dhwc_form_product_price_params.currency_format})};$("form.dhvcform").each(function(){var e=$(this);$(".dhvc-form-select--product select",e).each(function(){var a=$(this),e=a.closest("form"),r=$("input[name=product_price]",e),o=$(".dhvc_form_label div[data-name=product_image]",e),d=$("input[name=product_quantity]",e);o.data("html",o.html()),a.on("change",function(){var e=$("option:selected",a),t=e.data("price")?e.data("price"):0,t=parseFloat(t);d.val(1),r.val(woocommerce_formart_price(t)).data("base-price",t),e.data("image")?o.html(e.data("image")):o.html(o.data("html"))}),d.on("change",function(){var e=parseInt($(this).val());r.val(woocommerce_formart_price(e*parseFloat(r.data("base-price"))))})}),form_math(e),$(".dhvc-form-value",e).on("keyup change",function(e){form_math($(this).closest("form"))}),conditional_form(e),initForm(e)})})}(window.jQuery);